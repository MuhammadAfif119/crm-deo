# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
'on':
  push:
    branches:
      - main
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    env:
          PROJECT_ID: buildfire-project
          FIREBASE_TOKEN: 1//0gLU0fW6eFchwCgYIARAAGBASNwF-L9IrDw-rimHNFOezJbBWGSm_gRUNd6njmeu-dw2Jx8dyXTi6AOCQ3tHHhc9VXZgN-XfG36w
          CI: false
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
     
      - name: Install Firebase CLI
        run: npm install -g firebase-tools

      - name: Install project dependencies
        run: npm install

      - name: Build project for production
        run: npm run build

      - name: Add Firebase project
        run: firebase use --add ${{ secrets.FIREBASE_PROJECT_ID }} --token ${{ secrets.FIREBASE_TOKEN }}

      - name: Deploy Firebase Hosting for edrus-pasardigital
        run: |
          firebase target:apply hosting admin edrus-pasardigital
          firebase deploy --only hosting:admin --token "$FIREBASE_TOKEN"
      
      - name: Add Firebase project
        run: firebase use --add ${{ secrets.FIREBASE_PROJECT_ID }}

      - name: Deploy Firebase Hosting for edrus-testing
        run: |
          firebase target:apply hosting admin-testing edrus-testing
          firebase deploy --only hosting:admin-testing --token "$FIREBASE_TOKEN"
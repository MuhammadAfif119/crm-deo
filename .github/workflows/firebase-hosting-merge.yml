# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
'on':
  push:
    branches:
      - main
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    env:
          PROJECT_ID: buildfire-project
          TARGET: admin testing
          SITES: edrus-pasardigital edrus-test
          FIREBASE_TOKEN: 1//0gLU0fW6eFchwCgYIARAAGBASNwF-L9IrDw-rimHNFOezJbBWGSm_gRUNd6njmeu-dw2Jx8dyXTi6AOCQ3tHHhc9VXZgN-XfG36w
          CI: false
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
     
      - name: Install Firebase CLI
        run: npm install -g firebase-tools

      - name: install project
        run: npm install

      - name: build firebase
        run: npm run build

      - name: Deploy Firebase Hosting
        run: |
          for site in $TARGET
          do
            firebase target:apply hosting $site
            firebase deploy --only hosting:$site --token "$FIREBASE_TOKEN"
          done